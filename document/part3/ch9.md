# CH9 暗黙的な概念を明示的にする

* <b>深いモデリングはどうやって行うのか？</b>
    * その最初のステップはそのドメインにおける本質的な概念を、なんとかしてモデルで表現すること。

    * その後、議論で示唆されたり、設計の中に暗に存在する概念に開発者が気づき、モデルで明示的に表現したときにドメインモデルと対応したコードが大きく変化する。
    * 明示的に表現されたモデルを元に行われる連続したリファクタリングによって、徐々に深いモデリングへと繋がっていく。

    <b>暗黙的な概念を、荒削りであっても何らかの形で認識するところから始まる</b>

---

### 概念を掘り出す

* <b>開発者が暗黙的に潜んでいる概念を明らかにするためにどうすればいいか。</b>
    
    <br>

    * <b>ドメインエキスパートの言葉に耳を傾ける</b>
        * 複雑なものを簡潔に述べている用語がないか？
        * 特定のフレーズを使ったときに、ドメインエキスパートの困惑した表情が消えることはないか？

            <br>
            ドメイン駆動で設計されたコード、モデル、ドキュメントはユビキタス言語で構成されている。
            ユーザやドメインエキスパートとの会話の中で設計にない用語が使用された時は、その用語を取り込むことでモデルと設計を改善する好機。
    
    <br>
    
    * <b>ぎこちなさを精査する</b>
        * 設計において、手続きによって説明しにくい複雑な処理が行われていないか？
        * 新しい要求が出てくるたびに複雑さが増しているところがないか？

            <br>
            ぎこちなさを感じはしても、モデルの解決策がなかなか思い浮かばないかもしれない。
            そういう時は積極的にドメインエキスパートを調査に参加させ、モデル実験の検証の手助けをしてもらうべき。

    <br>

    * <b>矛盾について熟考する</b>
        * ドメインエキスパートは「自分の経験」と「要求」から物事を見る。論理的に整合しないところはないか？
            →用語のバリエーション、誤解に基づくものなど
        
    <br>

    * <b>文献を読む</b>
        * 多くの分野において、基本的な概念や社会通念について解説している文献がある。
        * 文献を読むことで、首尾一貫し深く検討された見方からの深いモデリングを始められるかもしれない。

<br>

* <b>何度でも挑戦することが重要である。</b>
    * そもそも、モデルを作ってみることができるくらいわかりやすくて有用なものを見つけるためには、会話に出てきた手がかりを数え切れないくらい辿らなければならない。
        - 何度もモデルを取り替える実験と知識の噛み砕きによって、より優れた考えが生み出される。
        - 設計者は自らの考え（モデル）に固執してはいけない。

    <br>
    
    * モデルの実験をすることでしか深いモデリングを行う方法がない。
        - 設計の誤りを避けようとすれば、結果としてできるものの品質は低くなる。
        - 簡単な実験を連続して行うほうが時間がかからない。

    <br>

    <b>一度作ったモデルで満足するな。</b>



---

### それほど明白でない概念をモデル化する方法

* オブジェクト指向における「名詞と動詞」
    * 抽象的なものも含めて、「物」がほとんどのオブジェクトモデルにとっての骨子となり（名詞）、
    そこに「物」によって行われるふるまいが付け加わる（動詞）

#### 明示的な制約

* 制約はモデルの概念において重要なカテゴリ
    * 明示的に表現することによって設計が大幅に向上するかもしれない
    * 時には、制約の自然な落ち着き場所がオブジェクトやメソッドのこともある。

<br>

* 制約の落ち着き場所
    * 簡単なクラスであれば、直接メソッドに制約を書いても明白である
    * 複雑なクラスになると制約が見えなくなってしまうため、別のメソッドとして括り出し、制約の意義を明確かつ明示的に表現する名前をつけるべき。
        * 制約が複雑になれば制約が適用されるオブジェクトやメソッドを圧倒し始める。
        * 制約を独立したメソッドに分解することで、そのメソッドに意図の明白な名前をつけて設計上でも制約を明示できるようになる。

    <br>

    - メソッドに独立させることで制約を拡大させることができるが、一つのメソッドに収めきれなくなることもある。
    - 制約がオブジェクトの主要な責務には必要ない情報を要求することもある。

    - そのような場合、制約を実装するオブジェクトの設計が制約によって歪められているかもしれない。

        <br>

        制約によってオブジェクトの責務が曖昧になっている場合、制約を括り出して明示的に１つのオブジェクトとするか、オブジェクトの集まりと制約の関係性としてモデル化してもいい。

#### ドメインオブジェクトとしてのプロセス

前提として、プロシージャ（手続き）をモデルの主要な側面にしたくない。
<b>オブジェクトは手続きをカプセル化し、その代わりに目標や意図について我々に考えさせるために存在する。</b>

* ドメインに存在するプロセスはモデルの中に表現されなければならない。

    - プロセスがすべてモデルの外へと姿を表すと、オブジェクト設計がぎこちなくなる。

* 明示すべきプロセスと隠蔽すべきプロセスの区別。

    * ドメインエキスパートが話題に上げるもの。（明示すべき）
    * コンピュータプログラムおける仕組みの一部にすぎない。（隠蔽すべき）

- 制約とプロセスはオブジェクト指向言語でプログラミングしている時にはすぐに思い浮かばない２大モデル概念。
    - いったんこれらをモデル要素として考えるようになると、設計は鋭くなる。

#### 仕様(SPECIFICATION)